$allow-text-overflow-trimming: true;

@namespace epub url(http://www.idpf.org/2007/ops);

@text-transform {
	system: ueb;
}

@page {
	size: 40 25;
	margin-bottom: 0;
	@top-center {
		content: string(running-header); // the running-header text must be set by the custom style sheet
	}
	@top-right {
		content: "   " string(print-page);
	}
	@bottom-right {
		content: "   " counter(page);
	}
}

@page frontmatter {
	counter-increment: frontmatter-page;
	@top-center {
		content: none;
	}
	@top-right {
		content: none;
	}
	@bottom-right {
		content: "   p" counter(frontmatter-page);
	}
}

@volume {
	@begin {
		content: flow(frontmatter, document); // the frontmatter content must be set by the custom style sheet
		page: frontmatter;
		counter-set: frontmatter-page 1;
	}
}

h1 {
	page-break-before: always;
	text-align: center;
	margin-left: 3;
	margin-right: 3;
	margin-bottom: 1;
}

h2 {
	margin-left: 4;
}

h3, h4 {
	margin-left: 6;
}

h1, h2, h3, h4 {
	margin-top: 1;
	page-break-after: avoid;
}

p {
	text-indent: 2;
}

li {
	text-indent: -2;
	margin-left: 2;
}

ul, ol {
	margin-top: 1;
	margin-bottom: 1;
	orphans: 2;

	h1 + &,
	h2 + &,
	h3 + &,
	h4 + & {
		margin-top: 0;
		> li:first-child {
			page-break-inside: avoid;
		}
	}
}

.page-front,
.page-normal,
.page-special,
[epub|type='pagebreak'] {
	display: block;
	&::before {
		content: leader("⠤"); // FIXME: remove space before number
	}
	margin-left: -40; // this is to make sure the line always starts all the way on the left
	string-set: print-page content();
	&[title] {
		string-set: print-page attr(title);
	}
}
